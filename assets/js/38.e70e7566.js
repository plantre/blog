(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{454:function(a,t,s){"use strict";s.r(t);var r=s(2),v=Object(r.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#锁"}},[a._v("#")]),a._v(" 锁")]),a._v(" "),t("h3",{attrs:{id:"基于属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基于属性"}},[a._v("#")]),a._v(" 基于属性")]),a._v(" "),t("h4",{attrs:{id:"共享锁-share-lock-s锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#共享锁-share-lock-s锁"}},[a._v("#")]),a._v(" 共享锁（Share Lock）(S锁)")]),a._v(" "),t("p",[t("code",[a._v("SELECT ... LOCK IN SHARE MODE")])]),a._v(" "),t("p",[a._v("其他事务只能对该数据加读锁，而不能加写锁")]),a._v(" "),t("p",[a._v("读数据的时候不支持修改，避免重复读")]),a._v(" "),t("h4",{attrs:{id:"排它锁-exclusive-lock-x锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#排它锁-exclusive-lock-x锁"}},[a._v("#")]),a._v(" 排它锁（eXclusive Lock）(X锁)")]),a._v(" "),t("p",[t("code",[a._v("SELECT ... FOR UPDATE")])]),a._v(" "),t("p",[a._v("其他事务不能为数据加任何锁")]),a._v(" "),t("p",[a._v("不允许其他人同时修改，不允许其他人读取，避免了出现出现脏数据和脏读")]),a._v(" "),t("h3",{attrs:{id:"基于粒度"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基于粒度"}},[a._v("#")]),a._v(" 基于粒度")]),a._v(" "),t("p",[t("strong",[a._v("表锁不会发生死锁，行锁会发生死锁")])]),a._v(" "),t("h4",{attrs:{id:"表锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#表锁"}},[a._v("#")]),a._v(" 表锁")]),a._v(" "),t("p",[t("code",[a._v("LOCK TABLES ... READ")])]),a._v(" "),t("p",[t("code",[a._v("LOCK TABLES ... WRITE")])]),a._v(" "),t("h4",{attrs:{id:"行锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#行锁"}},[a._v("#")]),a._v(" 行锁")]),a._v(" "),t("h4",{attrs:{id:"记录锁-record-lock"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#记录锁-record-lock"}},[a._v("#")]),a._v(" 记录锁（Record Lock）")]),a._v(" "),t("p",[a._v("唯一索引命中")]),a._v(" "),t("p",[a._v("避免重复读：数据在查询的时候被修改")]),a._v(" "),t("p",[a._v("避免脏读：在修改的事务未提交前被其他事务读取")]),a._v(" "),t("h4",{attrs:{id:"间隙锁-gap-lock"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#间隙锁-gap-lock"}},[a._v("#")]),a._v(" 间隙锁（Gap Lock）")]),a._v(" "),t("p",[a._v("左开右闭  (]")]),a._v(" "),t("p",[a._v("范围查询并且未命中记录，查询条件必须命中索引")]),a._v(" "),t("p",[a._v("只会出现在REPEATABLE_READ事务级别中")]),a._v(" "),t("p",[a._v("防止幻读问题")]),a._v(" "),t("h4",{attrs:{id:"临键锁-next-key-lock"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#临键锁-next-key-lock"}},[a._v("#")]),a._v(" 临键锁（Next-Key Lock）")]),a._v(" "),t("p",[a._v("InnoDB行锁默认算法")]),a._v(" "),t("p",[a._v("范围查询并命中，查询命中了索引")]),a._v(" "),t("p",[a._v("避免了脏读，重复读，幻读")]),a._v(" "),t("h3",{attrs:{id:"基于状态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基于状态"}},[a._v("#")]),a._v(" 基于状态")]),a._v(" "),t("h4",{attrs:{id:"意向共享锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#意向共享锁"}},[a._v("#")]),a._v(" 意向共享锁")]),a._v(" "),t("h4",{attrs:{id:"意向排它锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#意向排它锁"}},[a._v("#")]),a._v(" 意向排它锁")])])}),[],!1,null,null,null);t.default=v.exports}}]);